<h2 class="mb-3">Categories</h2>
<div class="mb-3">
  <div class="d-flex gap-2">
    <input class="form-control" placeholder="New category name" [(ngModel)]="newName" />
    <button class="btn btn-success" (click)="addCategory()">Add</button>
  </div>
</div>

<div *ngFor="let c of categories" class="mb-3 border rounded bg-white">
  <div class="d-flex justify-content-between align-items-center p-2">
    <div class="d-flex align-items-center gap-2">
      <button class="btn btn-sm btn-light" (click)="toggleExpand(c.id)" [attr.aria-expanded]="isExpanded(c.id)">
        <i class="fas" [ngClass]="isExpanded(c.id) ? 'fa-chevron-down' : 'fa-chevron-right'"></i>
      </button>
      <h5 class="mb-0">{{c.name}}</h5>
      <span class="badge bg-info">{{(c.subcategories||[]).length}} subcategories</span>
    </div>
    <div class="d-flex gap-2">
      <button class="btn btn-sm btn-danger" (click)="deleteCategory(c.id)">Delete</button>
    </div>
  </div>

  <div class="px-3 pb-3" *ngIf="isExpanded(c.id)">
    <!-- add subcategory under this category -->
    <div class="d-flex gap-2 mb-2">
      <input #subname class="form-control" placeholder="New subcategory name" />
      <button class="btn btn-outline-success" (click)="addSubcategory(c.id, subname.value); subname.value = ''">Add Subcategory</button>
    </div>

    <ul class="list-group">
      <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let s of (c.subcategories || [])">
        <span>{{s.name}}</span>
        <button class="btn btn-sm btn-danger" (click)="deleteSubcategory(s.id)">Delete</button>
      </li>
      <li class="list-group-item text-muted" *ngIf="!(c.subcategories||[]).length">No subcategories yet</li>
    </ul>
  </div>
</div>
